(function(e){var t="textareaHighlighter";var n=t+"data";var r="."+t+"_evt";var i={init:function(s){var o=e.extend({fontsize:14,cols:65,rows:3},s);var u={_helperel:null,_textareael:null,_fontsize:o.fontsize,_linesize:o.fontsize+2,_ishelperhidden:false};var a=this.val()||"";var f=this.attr("id")||t+Math.random().toString(36).substr(2,5);var l=this.css("backgroundColor")||"yellow";var c="normal "+u._fontsize+"px/"+u._linesize+'px "Courier New",Courier,monospace';var h={margin:"0",padding:"0",position:"relative",border:"1px solid #999999",outline:"none",overflow:"scroll",width:"100%",background:"transparent",resize:"none",font:c};var p={position:"absolute",background:l,"white-space":"pre",border:"1px solid transparent",color:"transparent",font:c,overflow:"scroll"};u._textareael=e('<textarea cols="'+o.cols+'" rows="'+o.rows+'" wrap="off">'+a+"</textarea>").attr("id",f).bind("keyup"+r,i._textareaonchange).bind("paste"+r,function(e){setTimeout(function(){i._textareaonchange(e)},1)});this.replaceWith(u._textareael);u._textareael.resizable({resize:i._textarearesize}).bind("scroll"+r,i._textareascroll).css(h);u._helperel=e("<span></span>").css(p).insertBefore(u._textareael);u._textareael.data(n,u);u._textareael.keyup()},destroy:function(){e(window).undind(r);$this=e(this);var t=$this.data(n);t._helperel.remove();t._textareael.resizable("destroy");t._textareael.remove();$this.removeData(n)},_textareascroll:function(t){$this=e(this);var r=$this.data(n);if(!r._ishelperhidden){r._helperel.scrollTop($this.scrollTop());r._helperel.scrollLeft($this.scrollLeft())}},_textarearesize:function(t){$this=e("textarea",this);var r=$this.data(n);if(!r._ishelperhidden){r._helperel.height($this.height());r._helperel.width($this.width())}},_textareaonchange:function(e){i._hidehelper.apply(this)},_hidehelper:function(){$this=e(this);var t=$this.data(n);if(!t._ishelperhidden){t._helperel.hide();t._ishelperhidden=true}},_showhelper:function(t){$this=e(this);var r=$this.data(n);if(r._ishelperhidden){r._helperel.show();r._ishelperhidden=false;$this.resizable("option","resize").apply($this.parent())}},highlight:function(t,r,s){$this=e(this);var o=$this.data(n);var u=$this.val();var a=[];a[0]=u.substring(0,t);a[1]=u.substring(t,r+1);a[2]=u.substring(r+1,u.length);o._helperel.html(a[0]+'<span style="background: '+s+'">'+a[1]+"</span>"+a[2]);i._showhelper.apply(this);o._textareael.scroll()}};e.fn[t]=function(t){var n=arguments;if(i[t]){return this.each(function(){i[t].apply(e(this),Array.prototype.slice.call(n,1))})}else if(typeof t==="object"||!t){return this.each(function(){i.init.apply(e(this),arguments)})}else{e.error("No method with name "+t+" for jQuery.textareaHighlighter")}}})(jQuery)